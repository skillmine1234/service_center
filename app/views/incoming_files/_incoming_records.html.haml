%table.table.table-bordered.table-striped.table-hover.align_center
  %thead
    %tr 
      %th{:style=>'text-align:left;'}
        = "Response"
      %th
  %tbody
  
    %tr
      %td{:style=>'text-align:left;'}
        = "Response File Name"
      %td{:style=>'text-align:left;'} 
        - if incoming_file.service_name == 'ECOL'
          = link_to "#{incoming_file.rep_file_name}", download_ecol_response_file_incoming_files_path(id: incoming_file.id)
        - else
          = incoming_file.rep_file_name
        &nbsp;
        - if !incoming_file.auto_upload? and (!ENV['CONFIG_SCP_IIB_FILE_MGR'].nil? or !ENV['CONFIG_SCP_IIB_FILE_MGR'].empty?) and incoming_file.status == 'C' and !incoming_file.rep_file_status.nil?
          = "("
          = link_to 'Download', download_file_incoming_file_path(incoming_file, :flag => 'response', :download => true)
          = "/"
          = link_to 'View', download_file_incoming_file_path(incoming_file, :flag => 'response', :view => true)
          = ")"
    %tr
      %td{:style=>'text-align:left;'}
        = "Response File Path"
      %td{:style=>'text-align:left;'}
        = incoming_file.rep_file_path
    %tr
      %td{:style=>'text-align:left;'}
        = "Response File Status"    
      %td{:style=>'text-align:left;'}
        = incoming_file.status_text(incoming_file.rep_file_status)
        &nbsp;
        - if incoming_file.status == 'C' && incoming_file.incoming_file_type.build_response_file == 'Y'
          - can = !(can? :generate_response_file, IncomingFile)
          = simple_form_for :incoming_file, :url => generate_response_file_incoming_file_path(incoming_file), :html => { :method => :get, :id => 'generate_records', :style=> 'overflow:  auto;display:inline-block;'} do |f| 
            = button_tag "Generate Response File", :id => 'submit_generate', :role => "button", :class => "btn btn-primary", :disabled => can

  
    - if incoming_file.incoming_file_type.build_nack_file == 'Y'
      %tr
        %td{:style=>'text-align:left;'}
          = "Nack File Name"
        %td{:style=>'text-align:left;'}
          = incoming_file.nack_file_name
          &nbsp;
          - if (!ENV['CONFIG_SCP_IIB_FILE_MGR'].nil? or !ENV['CONFIG_SCP_IIB_FILE_MGR'].empty?) and incoming_file.status == 'F' and !(incoming_file.nack_file_status.nil?)
            = "("
            = link_to 'Download', download_file_incoming_file_path(incoming_file, :flag => 'nack', :download => true)
            = "/"
            = link_to 'View', download_file_incoming_file_path(incoming_file, :flag => 'nack', :view => true)
            = ")"
      %tr
        %td{:style=>'text-align:left;'}
          = "Nack File Path"
        %td{:style=>'text-align:left;'}
          = incoming_file.nack_file_path
      %tr
        %td{:style=>'text-align:left;'}
          = "Nack File Status"    
        %td{:style=>'text-align:left;'}
          = incoming_file.status_text(incoming_file.nack_file_status)

%table.table.table-bordered.table-striped.table-hover.align_center
  %thead
    %tr
      %th{:style=>'text-align:left;'}
        File Type
      %th{:style=>'text-align:center; border-left: 3px solid #ffffff;'}
        Total Records
      %th{:style=>'text-align:center;'}
        Completed
      %th{:style=>'text-align:center;'}
        UnParsed
      %th{:style=>'text-align:center; border-right: 3px solid #ffffff;'}
        Failed
      %th{:style=>'text-align:center;'}
        Timed Out
      %th{:style=>'text-align:center; border-left: 3px solid #ffffff;'}
        Skipped
      %th{:style=>'text-align:center;'}
        Overriden
      %th{:style=>'text-align:center; border-right: 3px solid #ffffff;'}
        Retry
  %tbody
    %tr
      / - if incoming_file.service_name == 'ECOL'
      /   %td{:style=>'text-align:left;'}
      /     = "Remitter"    
      /   %td{:style=>'text-align:left;'}
      /     = incoming_file.record_count || 0
      /   %td{:style=>'text-align:left;'}
      /     = link_to incoming_file.bad_record_count || 0, incoming_file_records_path(:incoming_file_id => incoming_file.id, :status => 'BAD')
      /   %td{:style=>'text-align:left;'}
      /     = link_to incoming_file.timedout_record_count || 0, incoming_file_records_path(:incoming_file_id => incoming_file.id, :status => 'TIMED OUT')
      /   %td{:style=>'text-align:left;'}
      /     = link_to incoming_file.skipped_record_count || 0, incoming_file_records_path(:incoming_file_id => incoming_file.id, :status => 'SKIPPED')
      /   %td{:style=>'text-align:left;'}
      /     = link_to incoming_file.completed_record_count || 0, ecol_remitters_path(:incoming_file_id => incoming_file.id)
      /   %td{:style=>'text-align:left;'}
      /     = link_to incoming_file.failed_record_count || 0, incoming_file_records_path(:incoming_file_id => incoming_file.id, :status => 'FAILED')
      /   %td{:style=>'text-align:left;'}
      /     = '-'

      - if incoming_file.incoming_file_type.records_table.nil? && incoming_file.service_name == 'IMTSERVICE'
        %td{:style=>'text-align:left;'}
          = "IMT Transaction"
        %td{:style=>'text-align:center; border-left: 3px solid #ffffff;'}
          = incoming_file.record_count || 0
        %td{:style=>'text-align:center;'}
          = link_to incoming_file.completed_record_count || 0, incoming_file_records_path(:incoming_file_id => incoming_file.id, :status => 'COMPLETED')
        %td{:style=>'text-align:center;'}
          = link_to incoming_file.bad_record_count || 0, incoming_file_records_path(:incoming_file_id => incoming_file.id, :status => 'BAD')
        %td{:style=>'text-align:center; border-right: 3px solid #ffffff;'}
          = link_to incoming_file.failed_record_count || 0, incoming_file_records_path(:incoming_file_id => incoming_file.id, :status => 'FAILED')
        %td{:style=>'text-align:center;'}
          = link_to incoming_file.timedout_record_count || 0, incoming_file_records_path(:incoming_file_id => incoming_file.id, :status => 'TIMED OUT')
        %td{:style=>'text-align:center; border-left: 3px solid #ffffff;'}
          = link_to incoming_file.skipped_record_count || 0, incoming_file_records_path(:incoming_file_id => incoming_file.id, :status => 'SKIPPED')
        %td{:style=>'text-align:center;'}
          = '-'
        %td{:style=>'text-align:center; border-right: 3px solid #ffffff;'}
          = '-'

      - elsif !incoming_file.incoming_file_type.records_table.nil?
        - table = incoming_file.incoming_file_type.records_table
        %td{:style=>'text-align:left;'}
          = incoming_file.file_type
        %td{:style=>'text-align:center; border-left: 3px solid #ffffff;'}
          = incoming_file.record_count || 0
        %td{:style=>'text-align:center;'}
          = link_to incoming_file.completed_record_count || 0, public_send("#{table}_path",:file_name => incoming_file.file_name, :status => 'COMPLETED')
        %td{:style=>'text-align:center;'}
          = link_to incoming_file.bad_record_count || 0, incoming_file_records_path(:incoming_file_id => incoming_file.id, :status => 'BAD')
        %td{:style=>'text-align:center; border-right: 3px solid #ffffff;'}
          = link_to incoming_file.failed_record_count || 0, public_send("#{table}_path",:file_name => incoming_file.file_name, :status => 'FAILED')
        %td{:style=>'text-align:center;'}
          = link_to incoming_file.timedout_record_count || 0, public_send("#{table}_path",:file_name => incoming_file.file_name, :status => 'TIMED OUT')
        %td{:style=>'text-align:center; border-left: 3px solid #ffffff;'}
          = link_to incoming_file.skipped_record_count || 0, public_send("#{table}_path",:file_name => incoming_file.file_name, :status => 'SKIPPED')
        %td{:style=>'text-align:center;'}
          = link_to incoming_file.overriden_record_count || 0, public_send("#{table}_path",:file_name => incoming_file.file_name, :status => 'OVERRIDEN', :overrided_flag => 'true')
        %td{:style=>'text-align:center; border-right: 3px solid #ffffff;'}
          = link_to incoming_file.pending_retry_record_count || 0, public_send("#{table}_path",:file_name => incoming_file.file_name, :status => 'PENDING RETRY')